@model gogobuy.ViewModels.ProductDetailsViewModel

@{ ViewBag.Title = "ProductDetails"; }
<head>
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.13.0/css/all.css">
    <link rel="stylesheet" type="text/css" href="~/Content/css/ProductDetails.css">
    <style>
        .toast {
            left: 0;
            margin: auto;
            position: fixed;
            right: 0;
            text-align: center;
            width: 170px;
            z-index: 1;
            top: 40%;
        }
    </style>
</head>
<section class="container sproduct my-5 pt-5">
    <div class="row mt-5">
        <div class="col-lg-5 col-md-12 col-12">
            <img class="img-fluid rounded w-100 pb-1" src="~/Content/img/Product/@Model.fImgPath" id="Main-Img" alt="">
            <div class="small-img-group">
                @{ foreach (var imgPath in Model.listImgPath)
                    {
                        <div class="small-img-col">
                            <img src="~/Content/img/Product/@imgPath" style="width:100%" class="small-Img rounded" alt="">
                        </div> } }
                @*<div class="small-img-col">
                        <img src="~/Content/img/Product/f.fImgPath" width="100%" class="small-Img rounded" alt="">
                    </div>*@
                @*<div class="small-img-col">
                            <img src="~/Content/img/ProductDetails/sneakers2.jpg" width="100%" class="small-Img rounded" alt="">
                        </div>
                        <div class="small-img-col">
                            <img src="~/Content/img/ProductDetails/sneakers3.jpg" width="100%" class="small-Img rounded" alt="">
                    </div>*@
            </div>
        </div>


        <div class="col-lg-6 col-md-12 col-12">
            @*<h6>鞋子類</h6>*@
            <h6>@Model.fCategory</h6>
            @*<h3 class="py-4">東京限定Nike鞋</h3>*@
            <h3 class="py-4">@Model.fProductName</h3>
            @*<h2>NT$ 3999.00 元</h2>*@
            <h2>NT @String.Format("{0:0}", Model.fPrice) 元</h2>

            @{ foreach (var pStyle in Model.listStyle)
                            {
                                if ( Model.fPname != null)
                                {
                                    <select class="my-3">
                                    <option>選擇樣式</option>
                                    <option>@Model.fPname</option>
                                    </select>
                                }
                        } 
              }
            <input type="number" value=1 min=1 max=1 />
            <button class="btn buy-btn">
                <span class="me-2">加入購物車</span><i class="fas fa-shopping-cart"></i>
            </button>
            @{
                if (Model.isLike)
                {
                    <button class="btn btn-danger like" id="@Model.fProductID">
                        <span class="me-2">已收藏</span> <i class="fas fa-heart"></i>
                    </button>
                }
                else
                {
                    <button class="btn btn-outline-danger like" id="@Model.fProductID">

                        <span class="me-2">加入收藏</span> <i class="fas fa-heart"></i>
                    </button>
                }
            }

            <h6 class="my-3">賣家：@Model.fFirstName@Model.fLastName</h6>
            <h6 class="my-3">商品所在地：@Model.fProductLocation</h6>
            <h6 class="my-3">到貨時間：@Model.fArrivalTime</h6>
        </div>
    </div>
</section> <!-- product main section --> <!-- Tabs -->
<div class="container">
    <h2 class="py-3 text-center">產品描述</h2>
    <div class="row py-4 justify-content-center">
        <div class="col-md-8">
            <ul class="nav nav-tabs" id="ProductTab">
                <li class="nav-item">
                    <a href="" class="nav-link active" data-bs-toggle="tab" data-bs-target="#productDetails">
                        產品詳細資訊
                    </a>
                </li>
                <li class="nav-item">
                    <a href="" class="nav-link" data-bs-toggle="tab" data-bs-target="#comments">
                        評論
                    </a>
                </li>
            </ul>
            <div class="tab-content py-3" id="ContentTab">
                <div class="tab-pane fade show active" id="productDetails">
                    <div class="container-fluid pDetails row">
                        @*<div class="detailsPicture">
                                <img class="pPicture img-fluid mx-auto img-thumbnail" src="" alt="">
                            </div>*@
                        <div class="detailsText">
                            <img class="img-fluid rounded w-100 pb-1" src="~/Content/img/@Model.fImgPath" id="Main-Img" alt="">
                            <p class="mx-auto">@Model.fDescription</p>
                        </div>
                    </div>
                    <div class="container-fluid pDetails row">
                        @*<div class="detailsText">
                                <p class="mx-auto">Lorem ipsum dolor sit amet consectetur adipisicing elit. Quam quibusdam dolore nam, obcaecati qui molestiae libero laudantium soluta ullam, nesciunt ad fuga. Minus dolor sunt aliquam minima possimus nam quam mollitia saepe non recusandae? Laboriosam ratione debitis dignissimos error aperiam, ipsam expedita eius quisquam facere earum ut eos magni odio.</p>
                            </div>*@
                        @{ foreach (var imgPath in Model.listImgPath)
                            {
                                <div class="detailsPicture">
                                    <p>
                                        <img class="pPicture img-fluid mx-auto img-thumbnail" src="~/Content/img/Product/@imgPath" alt="">
                                    </p>
                                </div> } }
                    </div>
                    <div class="container-fluid pDetails row">
                        @*<div class="detailsText">
                                <p class="mx-auto">Lorem ipsum dolor sit amet consectetur adipisicing elit. Ullam provident harum earum expedita optio dignissimos?</p>
                            </div>*@
                        @*<div class="detailsPicture">
                                <img class="pPicture img-fluid mx-auto img-thumbnail" src="~/Content/img/Product/@imgPath" alt="">
                            </div>*@
                        @*<div class="detailsText">
                                <p class="mx-auto">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Placeat, quidem?</p>
                                <p class="mx-auto">Lorem ipsum dolor sit amet consectetur adipisicing elit. Animi corporis error expedita modi necessitatibus officia repellat! Sunt explicabo obcaecati sed quis possimus velit eius omnis?</p>
                            </div>*@
                    </div>
                </div>
                <div class="tab-pane fade" id="comments">
                    There is no comment yet.
                </div>
            </div>
        </div>
    </div>
</div> <!-- Tabs -->
<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="d-flex justify-content-end">
                <button type="button" class="btn-close m-2" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-center">
                要使用收藏功能，請先登入會員！
            </div>
            <div class="d-flex justify-content-end">
                <button type="button" class="btn btn-outline-secondary m-2" data-bs-dismiss="modal">關閉</button>
                <a href=@Url.Action("Login", "home") class="btn btn-primary  m-2">登入</a>
            </div>
        </div>
    </div>
</div>
<!-- Toast -->
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="check-circle-fill" fill="currentColor" viewBox="0 0 16 16">
        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z" />
    </symbol>
</svg>
<div class="toast alert-success" data-animation="true" data-autohide="false" id="myToast">
    <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Success:"><use xlink:href="#check-circle-fill" /></svg>
    <div class="toast-body">
        已加入購物車!
    </div>
</div>
<script>
    $('.buy-btn').click(function () {
        $.ajax({
             url: "@Url.Action("AddToCart", "ShoppingCart")",
             type: 'post',
             data: {
                productID: "@Model.fProductID"
             },
             async: true,
             success: function (data) {
                 if (data == 'success') {
                     $('#myToast').toast('show');
                     setTimeout(function () {
                         $('.toast').toast('hide');
                     }, 1000);
                 }
                 if (data == 'login') {
                     $('#myModal').modal('show');
                 }
             }
         });
        
    });
     $('button.like').click(function () {
     var productID = this.id;
     if ($(this).children('span').text() == '加入收藏') {
         $.ajax({
             url: "@Url.Action("LikeItem", "Collect")",
             type: 'post',
             data: {
                 productID: productID
             },
             async: true,
             success: function (data) {
                 if (data == 'success') {
                     $('#' + productID).children('span').text("已收藏");
                     $('#' + productID).removeClass('btn-outline-danger');
                     $('#' + productID).addClass('btn-danger');
                 }
                 if (data == 'login') {
                     $('#myModal').modal('show');
                 }
             }
         });
     } else {
         $.ajax({
             url: "@Url.Action("Delete", "Collect")",
             type: 'post',
             data: {
                 productID: productID
             },
             async: true,
             success: function (data) {
                 $('#' + productID).children('span').text("加入收藏");
                 $('#' + productID).removeClass('btn-danger');
                 $('#' + productID).addClass('btn-outline-danger');
             }
         });
     }
 });

 var MainImg = document.getElementById("Main-Img");
 var smallImg = document.getElementsByClassName("small-Img");

 smallImg[0].onclick = function () {
     MainImg.src = smallImg[0].src;
 };

 smallImg[1].onclick = function () {
     MainImg.src = smallImg[1].src;
 };

 smallImg[2].onclick = function () {
     MainImg.src = smallImg[2].src;
 };

</script>
